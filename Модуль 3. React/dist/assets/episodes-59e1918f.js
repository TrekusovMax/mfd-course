import{a as e,j as f,L as N,r as s}from"./index-e3ceca35.js";import{u as w,S as y,B as k}from"./useSort-a3e34a84.js";import{u as S}from"./useData-a1d26a1c.js";const b=({locations:o,lastNodeRef:c})=>{const{id:d,name:a}=o;return e("div",{ref:c,className:"w-full max-w-sm bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700",children:f("div",{className:"flex my-5 flex-col items-center",children:[e("h5",{className:"mb-1 text-xl font-medium text-gray-900 dark:text-white",children:a}),e("div",{className:"flex mt-4 space-x-3 md:mt-6",children:e(N,{to:`/episode/${d}`,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Подробнее"})})]})})},D=()=>{const o="https://rickandmortyapi.com/api/episode",[c,d]=s.useState(1),{loading:a,hasMore:h,error:x,data:n}=S(o,c),[i,g]=s.useState(n);s.useEffect(()=>{g(n)},[n]);const l=s.useRef(),u=s.useRef(),p=s.useCallback(r=>{a||(l.current&&l.current.disconnect(),l.current=new IntersectionObserver(t=>{t[0].isIntersecting&&h&&!u.current&&d(m=>m+1)}),r&&l.current.observe(r))},[a,h]);return w(i),f("div",{children:[f("div",{className:"flex justify-between",children:[e(y,{label:"Поиск эпизода",onChange:({target:r})=>{const{value:t}=r;t===""?u.current=void 0:u.current=t;const m=n.filter(v=>v.name.toLowerCase().indexOf(t.toLowerCase())>=0);g(m)}}),e(k,{})]}),a&&e("h2",{children:"Загрузка..."}),x&&e("h1",{className:"text-red-700",children:"Произошла ошибка"}),i.length?e("div",{className:"grid lg:grid-cols-4 justify-items-center md:grid-cols-2 my-4 gap-4 sm:grid-cols-1",children:i.map((r,t)=>i.length===t+1?e(b,{locations:r,lastNodeRef:p},r.id):e(b,{locations:r},r.id))}):e("p",{className:"mt-[200px] text-3xl",children:"Эпизодов не найдено"})]})};export{D as default};
